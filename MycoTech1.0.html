<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jard√≠n de Hongos - Versi√≥n Mejorada</title>
    <style>
        /* --- Reset y fuente global --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* --- Fondo general y estilo del body --- */
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c); /* Fondo degradado */
            color: #f0f0f0;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        /* --- Contenedor principal --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* --- Encabezado del juego --- */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        /* --- T√≠tulo principal --- */
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #ffcc00;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7), 2px 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: 2px;
        }

        /* --- Pesta√±as de navegaci√≥n (Jard√≠n, Caldero, Tienda) --- */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: rgba(139, 69, 19, 0.7);
            border-radius: 50px;
            padding: 5px;
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .tab {
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-align: center;
            flex: 1;
            font-size: 0.9rem;
        }

        .tab.active {
            background: #ffcc00;
            color: #000;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.7);
        }

        /* --- Informaci√≥n del juego (monedas, esporas, tiempo) --- */
        .game-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .info-box {
            background: rgba(139, 69, 19, 0.7);
            padding: 12px 20px;
            border-radius: 10px;
            min-width: 180px;
            text-align: center;
            font-size: 1.1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .info-box span {
            font-weight: bold;
            color: #ffcc00;
        }

        /* --- Secci√≥n principal con jard√≠n y tienda --- */
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        /* --- Secci√≥n del jard√≠n --- */
        .garden-section {
            flex: 1;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }

        .section-title {
            text-align: center;
            margin-bottom: 15px;
            color: #ffcc00;
            font-size: 1.6rem;
        }

        /* --- Grid de macetas del jard√≠n --- */
        .garden {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 15px;
        }

        /* --- Maceta individual --- */
        .pot {
            position: relative;
            height: 220px;
            background: rgba(139, 69, 19, 0.8);
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .pot:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }

        /* --- Parte superior de la maceta --- */
        .pot-top {
            width: 100%;
            height: 18px;
            background: rgba(210, 180, 140, 0.9);
            border-radius: 5px 5px 0 0;
        }

        /* --- Tierra de la maceta --- */
        .soil {
            width: 100%;
            height: 25px;
            background: #5d4037;
            position: relative;
        }

        /* --- Seta visual en la maceta --- */
        .mushroom {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            transition: all 0.5s ease;
            z-index: 2;
        }

        /* --- Tallo de la seta --- */
        .stem {
            background: #f5f5f5;
            width: 12px;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
        }
        
        .cap {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
            border-radius: 50% 50% 0 0;
        }
        
        .shop-section {
            flex: 1;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }
        
        .daily-customer-container {
            background: rgba(139, 69, 19, 0.7);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            margin-bottom: 30px; /* Espacio para el bot√≥n de vender */
            position: relative;
            overflow: hidden;
            min-height: 240px; /* M√°s alto para mostrar wishlist completa */
            height: auto;
        }
        
        .daily-customer {
            text-align: center;
            transition: transform 0.5s ease;
        }
        
        .customer-icon {
            font-size: 3.5rem;
            margin-bottom: 8px;
            animation: float 3s infinite ease-in-out;
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0); }
        }
        
        .wishlist {
            margin-top: 10px;
            font-size: 1rem;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px;
            border-radius: 8px;
            min-height: 80px; /* Asegura espacio para los deseos */
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .wishlist-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 0.9rem;
        }
        
        .seed-selector {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }
        
        .seeds {
            display: flex;
            justify-content: space-around;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .seed {
            background: rgba(139, 69, 19, 0.8);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 90px;
            font-size: 0.9rem;
        }
        
        .seed:hover {
            background: rgba(160, 82, 45, 0.9);
            transform: translateY(-3px);
        }
        
        .seed-icon {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .inventory {
            /* --- Inventario del jugador --- */
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
        }

        /* --- Grid de items del inventario --- */
        .inventory-items {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 12px;
        }

        /* --- Item individual del inventario --- */
        .inventory-item {
            background: rgba(139, 69, 19, 0.8);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            width: 90px;
            position: relative;
            font-size: 0.9rem;
        }

        /* --- Cantidad de cada item --- */
        .item-count {
            font-size: 1.4rem;
            font-weight: bold;
            color: #ffcc00;
        }

        /* --- Informaci√≥n de la fase de la seta --- */
        .phase-info {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.6);
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
        }
        
        .messages {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 25px;
            border-radius: 10px;
            z-index: 100;
            display: none;
            max-width: 90%;
            text-align: center;
        }
        
        /* Caldero M√°gico */
        .cauldron-section {
            display: none;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
        }
        
        .cauldron-container {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
        }
        
        .cauldron {
            position: relative;
            width: 250px;
            height: 250px;
            background: rgba(50, 50, 50, 0.7);
            border-radius: 50% 50% 40% 40%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            box-shadow: inset 0 -15px 25px rgba(0, 0, 0, 0.7), 0 0 15px rgba(139, 0, 139, 0.5);
            border: 4px solid #5a2a5a;
        }
        
        .cauldron-liquid {
            position: absolute;
            bottom: 15px;
            width: 80%;
            height: 70%;
            background: linear-gradient(to top, #4b0082, #8a2be2);
            border-radius: 50% 50% 30% 30%;
            opacity: 0.7;
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            transition: all 1s ease;
        }
        
        .cauldron-bubbles {
            position: absolute;
            width: 100%;
            height: 100%;
            bottom: 15px;
        }
        
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            animation: bubbleUp 3s infinite;
        }
        
        @keyframes bubbleUp {
            0% { transform: translateY(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-80px); opacity: 0; }
        }
        
        .ingredients {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .ingredient-slot {
            width: 70px;
            height: 70px;
            background: rgba(139, 69, 19, 0.6);
            border: 2px dashed #ffcc00;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .ingredient-slot.active {
            background: rgba(139, 69, 19, 0.9);
            border: 2px solid #ffcc00;
            box-shadow: 0 0 12px rgba(255, 204, 0, 0.7);
        }
        
        .mix-button {
            background: #ffcc00;
            color: #000;
            border: none;
            padding: 10px 25px;
            border-radius: 40px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 15px auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .mix-button:hover {
            background: #ffdd33;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        
        .mix-button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .crafting-items {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .crafted-item {
            background: rgba(139, 69, 19, 0.8);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            width: 110px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            font-size: 0.9rem;
        }
        
        .crafted-icon {
            font-size: 2.2rem;
            margin-bottom: 8px;
        }
        
        .crafted-name {
            font-size: 0.85rem;
            margin-bottom: 4px;
        }
        
        .crafted-count {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ffcc00;
        }
        
        .inventory-selector {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 300;
            width: 90%;
            max-width: 450px;
        }
        
        .inventory-selector-title {
            text-align: center;
            margin-bottom: 12px;
            color: #ffcc00;
            font-size: 1.2rem;
        }
        
        .inventory-options {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin: 12px 0;
        }
        
        .inventory-option {
            background: rgba(139, 69, 19, 0.8);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 90px;
            font-size: 0.9rem;
        }
        
        .inventory-option:hover {
            background: rgba(160, 82, 45, 0.9);
            transform: translateY(-3px);
        }
        
        .preparation-timer {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 15px;
            border-radius: 15px;
            z-index: 10;
            font-size: 1.1rem;
            color: #ffcc00;
            display: none;
        }
        
        .preparation-progress {
            width: 100%;
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .preparation-progress-bar {
            height: 100%;
            background: #ffcc00;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Tienda */
        .shop-section-tab {
            display: none;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            margin-top: 20px;
        }
        
        .shop-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .shop-item {
            background: rgba(139, 69, 19, 0.7);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        
        .shop-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .shop-item-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #ffcc00;
        }
        
        .shop-item-description {
            font-size: 0.9rem;
            margin-bottom: 15px;
            min-height: 60px;
        }
        
        .shop-item-level {
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .shop-item-price {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #ffcc00;
        }
        
        .buy-button {
            background: #ffcc00;
            color: #000;
            border: none;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
        }
        
        .buy-button:hover {
            background: #ffdd33;
            transform: scale(1.05);
        }
        
        .buy-button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .cat-garden {
            position: absolute;
            font-size: 2rem;
            z-index: 5;
            animation: catWalk 10s infinite linear;
        }
        
        @keyframes catWalk {
            0% { transform: translateX(-50px) translateY(0); }
            25% { transform: translateX(50px) translateY(-10px); }
            50% { transform: translateX(150px) translateY(0); }
            75% { transform: translateX(50px) translateY(10px); }
            100% { transform: translateX(-50px) translateY(0); }
        }
        
        .version-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: #ffcc00;
            padding: 8px;
            border-radius: 5px;
            font-size: 0.85rem;
            z-index: 500;
        }
        
        .watering-can {
            position: absolute;
            font-size: 1.5rem;
            z-index: 5;
            animation: watering 1s forwards;
        }
        
        @keyframes watering {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(-50px) rotate(30deg); opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .garden {
                grid-template-columns: 1fr;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .cauldron-container {
                flex-direction: column;
            }
            
            .tabs .tab {
                padding: 8px 15px;
                font-size: 0.8rem;
            }
        }
        
        /* --- Men√∫ debug discreto --- */
        #debugMenu {
        position: fixed;
        bottom: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px;
        border-radius: 5px;
        color: #fff;
        font-size: 12px;
        cursor: pointer;
        z-index: 1000;
    }

    #debugMenu button {
        margin: 2px;
        padding: 3px 8px;
        background: #333;
        border: 1px solid #666;
        color: #fff;
        border-radius: 3px;
        cursor: pointer;
    }

    #debugMenu button:hover {
        background: #444;
    }
</style>
    </style>
</head>
<body>
    <div class="version-info">Versi√≥n Mejorada 3.0</div>
    
    <div class="container">
        <header>
            <h1>Jard√≠n de Hongos</h1>
            <p>Gestiona tu jard√≠n, crea pociones y compra mejoras en la tienda</p>
            
            <div class="tabs">
                <div class="tab active" id="gardenTab">Jard√≠n</div>
                <div class="tab" id="cauldronTab">Caldero</div>
                <div class="tab" id="shopTab">Tienda</div>
            </div>
            
            <div class="game-info">
                <div class="info-box">
                    Monedas: <span id="coins">100</span>
                </div>
                <div class="info-box">
                    Esporas: <span id="spores">10</span>
                </div>
                <div class="info-box">
                    Tiempo: <span id="time">D√≠a 1</span>
                </div>
            </div>
        </header>
        
        <!-- Secci√≥n del Jard√≠n -->
        <div id="gardenContent">
            <div class="main-content">
                <div class="garden-section">
                    <h2 class="section-title">Tu Jard√≠n</h2>
                    <div class="garden">
                        <div class="pot" id="pot1">
                            <div class="pot-top"></div>
                            <div class="soil"></div>
                        </div>
                        <div class="pot" id="pot2">
                            <div class="pot-top"></div>
                            <div class="soil"></div>
                        </div>
                        <div class="pot" id="pot3">
                            <div class="pot-top"></div>
                            <div class="soil"></div>
                        </div>
                        <div class="pot" id="pot4">
                            <div class="pot-top"></div>
                            <div class="soil"></div>
                        </div>
                    </div>
                    
                    <div class="seed-selector" id="seedSelector">
                        <h3>Selecciona un tipo de seta</h3>
                        <div class="seeds">
                            <div class="seed" data-type="red">
                                <div class="seed-icon">üçÑ</div>
                                <div>Seta Roja</div>
                                <small>Costo: 5 monedas</small>
                                <div class="info">Crecimiento: R√°pido</div>
                            </div>
                            <div class="seed" data-type="blue">
                                <div class="seed-icon">üçÑ</div>
                                <div>Seta Azul</div>
                                <small>Costo: 10 monedas</small>
                                <div class="info">Crecimiento: Medio</div>
                            </div>
                            <div class="seed" data-type="purple">
                                <div class="seed-icon">üçÑ</div>
                                <div>Seta P√∫rpura</div>
                                <small>Costo: 15 monedas</small>
                                <div class="info">Crecimiento: Lento</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="shop-section">
                    <h2 class="section-title">Cliente del D√≠a</h2>
                    <div class="daily-customer-container">
                        <div class="daily-customer" id="dailyCustomer">
                            <div class="customer-icon" id="customerIcon">üßô‚Äç‚ôÄÔ∏è</div>
                            <div id="customerName">Bruja</div>
                            <div class="wishlist">
                                <h4>Lista de Deseos:</h4>
                                <div id="wishesContainer"></div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="mix-button" id="sellButton" style="margin-top: 15px; width: 100%;">
                        Vender al Cliente
                    </button>
                    
                    <div class="inventory">
                        <h3>Tu Inventario</h3>
                        <div class="inventory-items">
                            <div class="inventory-item">
                                <div>üçÑ Roja</div>
                                <div class="item-count" id="red-count">0</div>
                            </div>
                            <div class="inventory-item">
                                <div>üçÑ Azul</div>
                                <div class="item-count" id="blue-count">0</div>
                            </div>
                            <div class="inventory-item">
                                <div>üçÑ P√∫rpura</div>
                                <div class="item-count" id="purple-count">0</div>
                            </div>
                            <div class="inventory-item">
                                <div>‚ú® Esporas</div>
                                <div class="item-count" id="spores-count">10</div>
                            </div>
                            <div class="inventory-item">
                                <div>üß™ Pociones</div>
                                <div class="item-count" id="potion-count">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n del Caldero M√°gico -->
        <div class="cauldron-section" id="cauldronContent">
            <h2 class="section-title">Caldero M√°gico</h2>
            <p class="section-subtitle">Combina setas para crear pociones m√°gicas</p>
            
            <div class="preparation-timer" id="preparationTimer">
                Preparando poci√≥n... <span id="timerValue">0s</span>
                <div class="preparation-progress">
                    <div class="preparation-progress-bar" id="preparationProgress"></div>
                </div>
            </div>
            
            <div class="cauldron-container">
                <div class="cauldron">
                    <div class="cauldron-liquid" id="cauldronLiquid"></div>
                    <div class="cauldron-bubbles" id="cauldronBubbles"></div>
                </div>
                
                <div class="ingredients-container">
                    <div class="ingredients">
                        <div class="ingredient-slot" id="slot1" data-slot="1">+</div>
                        <div class="ingredient-slot" id="slot2" data-slot="2">+</div>
                    </div>
                    <button class="mix-button" id="mixButton" disabled>Mezclar Ingredientes</button>
                    <div id="cauldronQueueList" style="margin-top:15px;"></div>
                    <div class="crafting-result" id="craftingResult" style="display:none; text-align:center; margin-top:15px;">
                        <h3>¬°Has creado!</h3>
                        <div id="resultItem" style="font-size: 2.5rem; margin: 10px 0;"></div>
                        <div id="resultName" style="font-size: 1.1rem; font-weight:bold;"></div>
                    </div>
                </div>
            </div>
            
            <h3 class="section-title" style="margin-top: 30px;">Tus Creaciones</h3>
            <div class="crafting-items">
                <div class="crafted-item">
                    <div class="crafted-icon">üß™</div>
                    <div class="crafted-name">Poci√≥n Roja</div>
                    <div class="crafted-count" id="potion-red">0</div>
                </div>
                <div class="crafted-item">
                    <div class="crafted-icon">üß´</div>
                    <div class="crafted-name">Poci√≥n Azul</div>
                    <div class="crafted-count" id="potion-blue">0</div>
                </div>
                <div class="crafted-item">
                    <div class="crafted-icon">üîÆ</div>
                    <div class="crafted-name">Poci√≥n P√∫rpura</div>
                    <div class="crafted-count" id="potion-purple">0</div>
                </div>
                <div class="crafted-item">
                    <div class="crafted-icon">‚öóÔ∏è</div>
                    <div class="crafted-name">Mezcla Arco√≠ris</div>
                    <div class="crafted-count" id="potion-rainbow">0</div>
                </div>
                <div class="crafted-item">
                    <div class="crafted-icon">üß¨</div>
                    <div class="crafted-name">Elixir √âter</div>
                    <div class="crafted-count" id="potion-ether">0</div>
                </div>
            </div>
        </div>
        
        <!-- Secci√≥n de Tienda -->
        <div class="shop-section-tab" id="shopContent">
            <h2 class="section-title">Tienda de Mejoras</h2>
            <p class="section-subtitle">Compra objetos para mejorar tu jard√≠n</p>
            
            <div class="shop-items">
                <!-- Regadera -->
                <div class="shop-item">
                    <div class="shop-icon">üöø</div>
                    <div class="shop-item-title">Regadera M√°gica</div>
                    <div class="shop-item-description">
                        Acelera el crecimiento de tus setas. Nivel 1: 1 seta al d√≠a. Nivel 2: 2 setas. Nivel 3: 2 setas autom√°ticas.
                    </div>
                    <div class="shop-item-level">Nivel actual: <span id="watering-level">0</span></div>
                    <div class="shop-item-price" id="watering-price">Precio: 50 monedas</div>
                    <button class="buy-button" id="buy-watering">Comprar Mejora</button>
                </div>
                
                <!-- Fertilizante -->
                <div class="shop-item">
                    <div class="shop-icon">üß™</div>
                    <div class="shop-item-title">Fertilizante Especial</div>
                    <div class="shop-item-description">
                        Acelera el crecimiento de todas las setas. Nivel 1: 10% m√°s r√°pido. Nivel 2: 15%. Nivel 3: 20%.
                    </div>
                    <div class="shop-item-level">Nivel actual: <span id="fertilizer-level">0</span></div>
                    <div class="shop-item-price" id="fertilizer-price">Precio: 80 monedas</div>
                    <button class="buy-button" id="buy-fertilizer">Comprar Mejora</button>
                </div>
                
                <!-- Gato Jardinero -->
                <div class="shop-item">
                    <div class="shop-icon">üê±</div>
                    <div class="shop-item-title">Gato Jardinero</div>
                    <div class="shop-item-description">
                        Un gato que trabaja para ti. Nivel 1: Acci√≥n cada 30s. Nivel 2: 20s. Nivel 3: 8s.
                    </div>
                    <div class="shop-item-level">Nivel actual: <span id="cat-level">0</span></div>
                    <div class="shop-item-price" id="cat-price">Precio: 150 monedas</div>
                    <button class="buy-button" id="buy-cat">Comprar Mejora</button>
                </div>
                
                <!-- Rana Alquimista -->
                <div class="shop-item">
                    <div class="shop-icon">üê∏</div>
                    <div class="shop-item-title">Rana Alquimista</div>
                    <div class="shop-item-description">
                        Permite a√±adir recetas al caldero en cola (m√°ximo 5).
                    </div>
                    <div class="shop-item-price" id="frog-price">Precio: 200 monedas</div>
                    <button class="buy-button" id="buy-frog">Comprar Mejora</button>
                </div>
            </div>
        </div>
        
        <div class="messages" id="messageBox"></div>
        
        <div class="inventory-selector" id="inventorySelector">
            <h3 class="inventory-selector-title">Selecciona un ingrediente</h3>
            <div class="inventory-options">
                <div class="inventory-option" data-type="red">
                    <div>üçÑ Roja</div>
                    <div class="item-count" id="selector-red">0</div>
                </div>
                <div class="inventory-option" data-type="blue">
                    <div>üçÑ Azul</div>
                    <div class="item-count" id="selector-blue">0</div>
                </div>
                <div class="inventory-option" data-type="purple">
                    <div>üçÑ P√∫rpura</div>
                    <div class="item-count" id="selector-purple">0</div>
                </div>
            </div>
            <button class="buy-button" id="closeSelector" style="margin-top: 15px; background: #ff6b6b;">Cancelar</button>
        </div>
        
        <div id="debugMenu">
    <span style='opacity:0.7;'>Debug</span>
</div>
    </div>
    
    <script>
        // Estado del juego
        const gameState = {
            coins: 100,
            spores: 10,
            day: 1,
            selectedPot: null,
            inventory: {
                red: 0,
                blue: 0,
                purple: 0,
                potion: 0
            },
            craftedItems: {
                red: 0,
                blue: 0,
                purple: 0,
                rainbow: 0,
                ether: 0
            },
            garden: {
                pot1: null,
                pot2: null,
                pot3: null,
                pot4: null
            },
            dailyCustomer: null,
            dailyWishlist: null,
            currentSlot: null,
            ingredients: {
                slot1: null,
                slot2: null
            },
            growthIntervals: {},
            isPreparing: false,
            upgrades: {
                wateringCan: 0,
                fertilizer: 0,
                cat: 0
            },
            wateringUses: 0,
            catInterval: null,
            alchemistFrog: false,
            cauldronQueue: [], // Queue for recipes, max 5
        };
        
        // Velocidades de crecimiento (ms por fase) - reducidas a la mitad
        const growthSpeeds = {
            red: 400,    // M√°s r√°pido
            blue: 600,   // Medio
            purple: 900  // M√°s lento
        };
        
        // Precios de las setas
        const mushroomPrices = {
            red: 5,
            blue: 10,
            purple: 15
        };
        
        // Precios de venta por cliente
        const sellPrices = {
            witch: {
                mushroom: 3,
                potion_red: 15,
                rainbow: 25
            },
            elf: {
                mushroom: 5,
                potion_blue: 20,
                rainbow: 30
            },
            zombie: {
                mushroom: 8,
                potion_purple: 30,
                ether: 50
            },
            warrior: {
                mushroom: 6,
                potion_red: 18,
                ether: 40
            },
            alchemist: {
                potion_red: 20,
                potion_blue: 22,
                potion_purple: 28,
                rainbow: 35,
                ether: 55
            },
            goblin: {
                mushroom: 4,
                potion_blue: 15,
                potion_purple: 20,
                rainbow: 28
            },
            rogue: {
                mushroom: 7,
                potion_purple: 25,
                rainbow: 32,
                ether: 45
            },
            sage: {
                potion_purple: 35,
                rainbow: 40,
                ether: 60
            },
            wizard: {
                mushroom: 5,
                potion_red: 17,
                potion_blue: 19,
                rainbow: 33
            },
            druid: {
                mushroom: 6,
                potion_red: 16,
                potion_blue: 18,
                potion_purple: 22,
                rainbow: 30,
                ether: 48
            }
        };
        
        // Tiempos de preparaci√≥n para pociones (segundos)
        const preparationTimes = {
            red: 30,      // Poci√≥n roja (r√°pida)
            blue: 40,     // Poci√≥n azul (media)
            purple: 50,   // Poci√≥n p√∫rpura (lenta)
            rainbow: 45,  // Mezcla arco√≠ris
            ether: 60     // Elixir √©ter (m√°s lento)
        };
        
        // Combinaciones para el caldero
        const combinations = {
            "red-red": { item: "red", name: "Mena de Cobre", emoji: "ü™®" },
            "blue-blue": { item: "blue", name: "Mena de Hierro", emoji: "‚õìÔ∏è" },
            "purple-purple": { item: "purple", name: "Amatista", emoji: "üíé" },
            "red-blue": { item: "rainbow", name: "Combustible Biol√≥gico", emoji: "üß™" },
            "blue-purple": { item: "ether", name: "Bioconcreto", emoji: "üß±" },
            "red-purple": { item: "rainbow", name: "Combustible Biol√≥gico", emoji: "üß™" },
            "blue-red": { item: "rainbow", name: "Combustible Biol√≥gico", emoji: "üß™" },
            "purple-blue": { item: "ether", name: "Bioconcreto", emoji: "üß±" },
            "purple-red": { item: "rainbow", name: "Combustible Biol√≥gico", emoji: "üß™" }
        };
        
        // Precios de mejoras
        const upgradePrices = {
            wateringCan: [50, 100, 200],
            fertilizer: [80, 150, 250],
            cat: [150, 300, 500]
        };
        
        // Referencias DOM
        const coinsEl = document.getElementById('coins');
        const sporesEl = document.getElementById('spores');
        const timeEl = document.getElementById('time');
        const seedSelector = document.getElementById('seedSelector');
        const messageBox = document.getElementById('messageBox');
        const redCountEl = document.getElementById('red-count');
        const blueCountEl = document.getElementById('blue-count');
        const purpleCountEl = document.getElementById('purple-count');
        const sporesCountEl = document.getElementById('spores-count');
        const potionCountEl = document.getElementById('potion-count');
        const gardenTab = document.getElementById('gardenTab');
        const cauldronTab = document.getElementById('cauldronTab');
        const shopTab = document.getElementById('shopTab');
        const gardenContent = document.getElementById('gardenContent');
        const cauldronContent = document.getElementById('cauldronContent');
        const shopContent = document.getElementById('shopContent');
        const inventorySelector = document.getElementById('inventorySelector');
        const mixButton = document.getElementById('mixButton');
        const slot1 = document.getElementById('slot1');
        const slot2 = document.getElementById('slot2');
        const craftingResult = document.getElementById('craftingResult');
        const resultItem = document.getElementById('resultItem');
        const resultName = document.getElementById('resultName');
        const preparationTimer = document.getElementById('preparationTimer');
        const timerValue = document.getElementById('timerValue');
        const preparationProgress = document.getElementById('preparationProgress');
        const customerIcon = document.getElementById('customerIcon');
        const customerName = document.getElementById('customerName');
        const wishRed = document.getElementById('wish-red');
        const wishPotionRed = document.getElementById('wish-potion-red');
        const wishRainbow = document.getElementById('wish-rainbow');
        const sellButton = document.getElementById('sellButton');
        
        // Elementos de pociones
        const potionRedEl = document.getElementById('potion-red');
        const potionBlueEl = document.getElementById('potion-blue');
        const potionPurpleEl = document.getElementById('potion-purple');
        const potionRainbowEl = document.getElementById('potion-rainbow');
        const potionEtherEl = document.getElementById('potion-ether');
        
        // Elementos de la tienda
        const wateringLevelEl = document.getElementById('watering-level');
        const wateringPriceEl = document.getElementById('watering-price');
        const buyWateringBtn = document.getElementById('buy-watering');
        const fertilizerLevelEl = document.getElementById('fertilizer-level');
        const fertilizerPriceEl = document.getElementById('fertilizer-price');
        const buyFertilizerBtn = document.getElementById('buy-fertilizer');
        const catLevelEl = document.getElementById('cat-level');
        const catPriceEl = document.getElementById('cat-price');
        const buyCatBtn = document.getElementById('buy-cat');
        const frogPriceEl = document.getElementById('frog-price');
        const buyFrogBtn = document.getElementById('buy-frog');
        
        // Inicializaci√≥n del juego
        function initGame() {
            generateDailyCustomer();
            updateUI();
            setupEventListeners();
            startDayCycle();
            createBubbles();
            startCatAssistant();
        }
        
        // Generar cliente diario y su lista de deseos
        function generateDailyCustomer() {
            const customers = [
                { 
                    type: 'witch', 
                    name: 'Bruja', 
                    icon: 'üßô‚Äç‚ôÄÔ∏è', 
                    items: ['red', 'potion_red', 'rainbow'] 
                },
                { 
                    type: 'elf', 
                    name: 'Elfo', 
                    icon: 'üßù‚Äç‚ôÇÔ∏è', 
                    items: ['blue', 'potion_blue', 'rainbow'] 
                },
                { 
                    type: 'zombie', 
                    name: 'Zombi', 
                    icon: 'üßü‚Äç‚ôÇÔ∏è', 
                    items: ['purple', 'potion_purple', 'ether'] 
                },
                {
                    type: 'warrior',
                    name: 'Guerrero',
                    icon: 'üó°Ô∏è',
                    items: ['red', 'potion_red', 'ether']
                },
                {
                    type: 'alchemist',
                    name: 'Alquimista',
                    icon: '‚öóÔ∏è',
                    items: ['potion_red', 'potion_blue', 'potion_purple', 'rainbow', 'ether']
                },
                {
                    type: 'goblin',
                    name: 'Duende',
                    icon: 'üë∫',
                    items: ['blue', 'purple', 'rainbow']
                },
                {
                    type: 'rogue',
                    name: 'P√≠caro',
                    icon: 'üïµÔ∏è‚Äç‚ôÇÔ∏è',
                    items: ['purple', 'rainbow', 'ether']
                },
                {
                    type: 'sage',
                    name: 'Sabio',
                    icon: 'üßô',
                    items: ['potion_purple', 'rainbow', 'ether']
                },
                {
                    type: 'wizard',
                    name: 'Mago',
                    icon: 'ü™Ñ',
                    items: ['red', 'blue', 'potion_red', 'potion_blue', 'rainbow']
                },
                {
                    type: 'druid',
                    name: 'Druida',
                    icon: 'üåø',
                    items: ['red', 'blue', 'purple', 'rainbow', 'ether']
                }
            ];
            
            const customer = customers[Math.floor(Math.random() * customers.length)];
            gameState.dailyCustomer = customer;

            // Determinar dificultad seg√∫n el d√≠a
            let wishlistItems = [];
            if (gameState.day <= 5) {
                // Primeros 5 d√≠as: solo 1 objeto
                wishlistItems = [customer.items[Math.floor(Math.random() * customer.items.length)]];
            } else if (gameState.day <= 10) {
                // D√≠as 6-10: solo 2 objetos distintos
                wishlistItems = [...customer.items];
                // Mezclar y tomar 2
                for (let i = wishlistItems.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [wishlistItems[i], wishlistItems[j]] = [wishlistItems[j], wishlistItems[i]];
                }
                wishlistItems = wishlistItems.slice(0, 2);
            } else {
                // Dificultad normal: todos los objetos posibles
                wishlistItems = [...customer.items];
            }

            // Generar lista de deseos seg√∫n dificultad
            gameState.dailyWishlist = {};
            wishlistItems.forEach(item => {
                if (gameState.day <= 5) {
                    gameState.dailyWishlist[item] = 1;
                } else if (gameState.day <= 10) {
                    gameState.dailyWishlist[item] = 2;
                } else {
                    gameState.dailyWishlist[item] = Math.floor(Math.random() * 2) + 1; // 1-2 de cada art√≠culo
                }
            });
        }
        
        // Actualizar la interfaz de usuario
        function updateUI() {
            coinsEl.textContent = gameState.coins;
            sporesEl.textContent = gameState.spores;
            timeEl.textContent = `D√≠a ${gameState.day}`;
            redCountEl.textContent = gameState.inventory.red;
            blueCountEl.textContent = gameState.inventory.blue;
            purpleCountEl.textContent = gameState.inventory.purple;
            sporesCountEl.textContent = gameState.spores;
            potionCountEl.textContent = Object.values(gameState.craftedItems).reduce((a, b) => a + b, 0);
            
            // Actualizar selector de inventario
            document.getElementById('selector-red').textContent = gameState.inventory.red;
            document.getElementById('selector-blue').textContent = gameState.inventory.blue;
            document.getElementById('selector-purple').textContent = gameState.inventory.purple;
            
            // Actualizar pociones
            potionRedEl.textContent = gameState.craftedItems.red;
            potionBlueEl.textContent = gameState.craftedItems.blue;
            potionPurpleEl.textContent = gameState.craftedItems.purple;
            potionRainbowEl.textContent = gameState.craftedItems.rainbow;
            potionEtherEl.textContent = gameState.craftedItems.ether;
            
            // Actualizar cliente diario
            if (gameState.dailyCustomer) {
                customerIcon.textContent = gameState.dailyCustomer.icon;
                customerName.textContent = gameState.dailyCustomer.name;
                renderCustomerWishes();
            }
        // Nueva funci√≥n para mostrar los deseos reales del cliente
        function renderCustomerWishes() {
            const wishesContainer = document.getElementById('wishesContainer');
            if (!wishesContainer) return;
            wishesContainer.innerHTML = '';
            if (!gameState.dailyWishlist) return;
            for (const item in gameState.dailyWishlist) {
                const cantidad = gameState.dailyWishlist[item];
                let label = '';
                let emoji = '';
                switch (item) {
                    case 'red': label = 'Setas Rojas'; emoji = 'üçÑ'; break;
                    case 'blue': label = 'Setas Azules'; emoji = 'üçÑ'; break;
                    case 'purple': label = 'Setas P√∫rpuras'; emoji = 'üçÑ'; break;
                    case 'potion_red': label = 'Pociones Rojas'; emoji = 'üß™'; break;
                    case 'potion_blue': label = 'Pociones Azules'; emoji = 'üß´'; break;
                    case 'potion_purple': label = 'Pociones P√∫rpuras'; emoji = 'üîÆ'; break;
                    case 'rainbow': label = 'Mezclas Arco√≠ris'; emoji = '‚öóÔ∏è'; break;
                    case 'ether': label = 'Elixires √âter'; emoji = 'üß¨'; break;
                    default: label = item; emoji = '';
                }
                const wishEl = document.createElement('div');
                wishEl.innerHTML = `${emoji} <span>${label}:</span> <b>${cantidad}</b>`;
                wishesContainer.appendChild(wishEl);
            }
        }
            
            // Actualizar macetas
            for (const potId in gameState.garden) {
                const pot = document.getElementById(potId);
                const mushroom = gameState.garden[potId];
                
                // Limpiar cualquier seta existente
                const existingMushroom = pot.querySelector('.mushroom');
                if (existingMushroom) {
                    pot.removeChild(existingMushroom);
                }
                
                if (mushroom) {
                    // Crear elemento de seta
                    const mushroomEl = document.createElement('div');
                    mushroomEl.className = 'mushroom';
                    
                    // Crear tallo
                    const stemEl = document.createElement('div');
                    stemEl.className = 'stem';
                    stemEl.style.height = `${mushroom.height}px`;
                    stemEl.style.backgroundColor = mushroom.stemColor;
                    
                    // Crear sombrero
                    const capEl = document.createElement('div');
                    capEl.className = 'cap';
                    capEl.style.width = `${mushroom.capSize}px`;
                    capEl.style.height = `${mushroom.capSize/1.5}px`;
                    capEl.style.backgroundColor = mushroom.capColor;
                    capEl.style.bottom = `${mushroom.height}px`;
                    
                    // Crear etiqueta de fase
                    const phaseEl = document.createElement('div');
                    phaseEl.className = 'phase-info';
                    phaseEl.textContent = `Fase ${mushroom.phase}`;
                    
                    // Agregar elementos a la seta
                    mushroomEl.appendChild(stemEl);
                    mushroomEl.appendChild(capEl);
                    mushroomEl.appendChild(phaseEl);
                    
                    // Agregar seta a la maceta
                    pot.appendChild(mushroomEl);
                }
            }
            
            // Actualizar slots del caldero
            updateCauldronSlots();
            
            // Actualizar tienda
            updateShopUI();
        }
        
        // Actualizar los slots del caldero
        function updateCauldronSlots() {
            // Slot 1
            if (gameState.ingredients.slot1) {
                slot1.innerHTML = gameState.ingredients.slot1 === 'red' ? 'üçÑ' : 
                                 gameState.ingredients.slot1 === 'blue' ? 'üçÑ' : 'üçÑ';
                slot1.style.fontSize = '2.2rem';
                slot1.style.backgroundColor = gameState.ingredients.slot1 === 'red' ? 'rgba(255, 100, 100, 0.7)' :
                                             gameState.ingredients.slot1 === 'blue' ? 'rgba(100, 100, 255, 0.7)' : 
                                             'rgba(180, 100, 255, 0.7)';
            } else {
                slot1.innerHTML = '+';
                slot1.style.fontSize = '1.8rem';
                slot1.style.backgroundColor = 'rgba(139, 69, 19, 0.6)';
            }
            
            // Slot 2
            if (gameState.ingredients.slot2) {
                slot2.innerHTML = gameState.ingredients.slot2 === 'red' ? 'üçÑ' : 
                                 gameState.ingredients.slot2 === 'blue' ? 'üçÑ' : 'üçÑ';
                slot2.style.fontSize = '2.2rem';
                slot2.style.backgroundColor = gameState.ingredients.slot2 === 'red' ? 'rgba(255, 100, 100, 0.7)' :
                                             gameState.ingredients.slot2 === 'blue' ? 'rgba(100, 100, 255, 0.7)' : 
                                             'rgba(180, 100, 255, 0.7)';
            } else {
                slot2.innerHTML = '+';
                slot2.style.fontSize = '1.8rem';
                slot2.style.backgroundColor = 'rgba(139, 69, 19, 0.6)';
            }
            
            // Activar o desactivar bot√≥n de mezcla
            if (gameState.alchemistFrog) {
                // Si tienes la rana, el bot√≥n solo se desactiva si no hay ingredientes
                mixButton.disabled = !(gameState.ingredients.slot1 && gameState.ingredients.slot2);
            } else {
                mixButton.disabled = !(gameState.ingredients.slot1 && gameState.ingredients.slot2) || gameState.isPreparing;
            }
        }
            // Mostrar cola visual si la rana est√° activa y hay m√°s de una receta en cola
            const queueList = document.getElementById('cauldronQueueList');
            if (gameState.alchemistFrog && gameState.cauldronQueue.length > 1) {
                let html = '<div style="background:rgba(0,0,0,0.3);border-radius:10px;padding:8px 12px;"><b>Cola de recetas:</b><ul style="margin:8px 0 0 0;padding:0;list-style:none;">';
                gameState.cauldronQueue.forEach((receta, idx) => {
                    const combo = combinations[receta.slot1 + '-' + receta.slot2];
                    html += `<li style='margin-bottom:4px;'>${combo ? combo.emoji : 'üçÑ'} <span>${combo ? combo.name : receta.slot1 + ' + ' + receta.slot2}</span></li>`;
                });
                html += '</ul></div>';
                queueList.innerHTML = html;
            } else {
                queueList.innerHTML = '';
            }
        
        // Actualizar la interfaz de la tienda
        function updateShopUI() {
            // Regadera
            wateringLevelEl.textContent = gameState.upgrades.wateringCan;
            const nextWateringLevel = gameState.upgrades.wateringCan < 3 ? gameState.upgrades.wateringCan + 1 : 3;
            const wateringPrice = nextWateringLevel <= 3 ? upgradePrices.wateringCan[nextWateringLevel - 1] : 'MAX';
            wateringPriceEl.textContent = `Precio: ${wateringPrice} monedas`;
            buyWateringBtn.disabled = gameState.upgrades.wateringCan >= 3 || gameState.coins < upgradePrices.wateringCan[nextWateringLevel - 1];
            buyWateringBtn.textContent = gameState.upgrades.wateringCan >= 3 ? 'M√°ximo nivel' : 'Comprar Mejora';
            
            // Fertilizante
            fertilizerLevelEl.textContent = gameState.upgrades.fertilizer;
            const nextFertilizerLevel = gameState.upgrades.fertilizer < 3 ? gameState.upgrades.fertilizer + 1 : 3;
            const fertilizerPrice = nextFertilizerLevel <= 3 ? upgradePrices.fertilizer[nextFertilizerLevel - 1] : 'MAX';
            fertilizerPriceEl.textContent = `Precio: ${fertilizerPrice} monedas`;
            buyFertilizerBtn.disabled = gameState.upgrades.fertilizer >= 3 || gameState.coins < upgradePrices.fertilizer[nextFertilizerLevel - 1];
            buyFertilizerBtn.textContent = gameState.upgrades.fertilizer >= 3 ? 'M√°ximo nivel' : 'Comprar Mejora';
            
            // Gato jardinero
            catLevelEl.textContent = gameState.upgrades.cat;
            const nextCatLevel = gameState.upgrades.cat < 3 ? gameState.upgrades.cat + 1 : 3;
            const catPrice = nextCatLevel <= 3 ? upgradePrices.cat[nextCatLevel - 1] : 'MAX';
            catPriceEl.textContent = `Precio: ${catPrice} monedas`;
            buyCatBtn.disabled = gameState.upgrades.cat >= 3 || gameState.coins < upgradePrices.cat[nextCatLevel - 1];
            buyCatBtn.textContent = gameState.upgrades.cat >= 3 ? 'M√°ximo nivel' : 'Comprar Mejora';
            
            // Rana Alquimista
            frogPriceEl.textContent = `Precio: 200 monedas`;
            buyFrogBtn.disabled = gameState.alchemistFrog || gameState.coins < 200;
            buyFrogBtn.textContent = gameState.alchemistFrog ? 'Ya tienes esta mejora' : 'Comprar Mejora';
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Macetas
            document.querySelectorAll('.pot').forEach(pot => {
                pot.addEventListener('click', () => handlePotClick(pot.id));
            });
            
            // Semillas
            document.querySelectorAll('.seed').forEach(seed => {
                seed.addEventListener('click', () => handleSeedSelect(seed.dataset.type));
            });
            
            // Tabs
            gardenTab.addEventListener('click', () => switchTab('garden'));
            cauldronTab.addEventListener('click', () => switchTab('cauldron'));
            shopTab.addEventListener('click', () => switchTab('shop'));
            
            // Slots del caldero
            slot1.addEventListener('click', () => openInventorySelector(1));
            slot2.addEventListener('click', () => openInventorySelector(2));
            
            // Bot√≥n de mezcla
            mixButton.addEventListener('click', mixIngredients);
            
            // Bot√≥n de vender
            sellButton.addEventListener('click', sellToCustomer);
            
            // Selector de inventario
            document.querySelectorAll('.inventory-option').forEach(option => {
                option.addEventListener('click', () => selectIngredient(option.dataset.type));
            });
            
            // Cerrar selector
            document.getElementById('closeSelector').addEventListener('click', () => {
                inventorySelector.style.display = 'none';
            });
            
            // Botones de compra
            buyWateringBtn.addEventListener('click', () => buyUpgrade('wateringCan'));
            buyFertilizerBtn.addEventListener('click', () => buyUpgrade('fertilizer'));
            buyCatBtn.addEventListener('click', () => buyUpgrade('cat'));
            buyFrogBtn.addEventListener('click', () => {
                if (gameState.coins >= 200 && !gameState.alchemistFrog) {
                    gameState.coins -= 200;
                    gameState.alchemistFrog = true;
                    updateUI();
                    showMessage('¬°Has comprado la Rana Alquimista! Ahora puedes poner recetas en cola en el caldero.');
                } else {
                    showMessage('No tienes suficientes monedas o ya has comprado esta mejora.');
                }
            });
        }
        
        // Cambiar entre pesta√±as
        function switchTab(tab) {
            gardenTab.classList.remove('active');
            cauldronTab.classList.remove('active');
            shopTab.classList.remove('active');
            
            gardenContent.style.display = 'none';
            cauldronContent.style.display = 'none';
            shopContent.style.display = 'none';
            
            if (tab === 'garden') {
                gardenTab.classList.add('active');
                gardenContent.style.display = 'block';
            } else if (tab === 'cauldron') {
                cauldronTab.classList.add('active');
                cauldronContent.style.display = 'block';
            } else if (tab === 'shop') {
                shopTab.classList.add('active');
                shopContent.style.display = 'block';
            }
        }
        
        // Manejar clic en maceta
        function handlePotClick(potId) {
            const mushroom = gameState.garden[potId];
            
            if (!mushroom) {
                // Maceta vac√≠a - mostrar selector de semillas
                gameState.selectedPot = potId;
                seedSelector.style.display = 'block';
                showMessage("Selecciona un tipo de seta para plantar");
            } else if (mushroom.phase === 5) {
                // Cosechar seta normal
                harvestMushroom(potId, mushroom);
            } else if (mushroom.phase === 6) {
                // Cosechar seta especial con esporas
                harvestSpecialMushroom(potId, mushroom);
            } else {
                // Usar regadera si est√° disponible
                if (gameState.upgrades.wateringCan > 0 && gameState.wateringUses < gameState.upgrades.wateringCan) {
                    useWateringCan(potId, mushroom);
                } else {
                    showMessage(`La seta est√° creciendo (Fase ${mushroom.phase}/6)`);
                }
            }
        }
        
        // Usar la regadera en una seta
        function useWateringCan(potId, mushroom) {
            if (mushroom.phase < 6) {
                mushroom.phase++;
                mushroom.growthProgress = 0;
                
                // Aumentar tama√±o
                if (mushroom.phase <= 5) {
                    mushroom.height += 15;
                    mushroom.capSize += 5;
                }
                
                // Mostrar efecto visual
                const pot = document.getElementById(potId);
                const wateringEffect = document.createElement('div');
                wateringEffect.className = 'watering-can';
                wateringEffect.textContent = 'üöø';
                wateringEffect.style.left = `${Math.random() * 70 + 15}%`;
                pot.appendChild(wateringEffect);
                
                // Eliminar despu√©s de la animaci√≥n
                setTimeout(() => {
                    if (wateringEffect.parentNode) {
                        wateringEffect.parentNode.removeChild(wateringEffect);
                    }
                }, 1000);
                
                gameState.wateringUses++;
                showMessage(`¬°Has usado la regadera en una seta! (Usos restantes: ${gameState.upgrades.wateringCan - gameState.wateringUses})`);
                
                // Actualizar UI
                updateUI();
                
                // Mostrar mensaje si alcanza fase 6
                if (mushroom.phase === 6) {
                    showMessage(`¬°La seta ha alcanzado la fase 6 y producir√° esporas especiales!`);
                    createSporeEffect(potId);
                }
            } else {
                showMessage("¬°Esta seta ya est√° completamente crecida!");
            }
        }
        
        // Comprar mejora en la tienda
        function buyUpgrade(type) {
            const currentLevel = gameState.upgrades[type];
            if (currentLevel >= 3) {
                showMessage("¬°Ya tienes el m√°ximo nivel de esta mejora!");
                return;
            }
            
            const price = upgradePrices[type][currentLevel];
            if (gameState.coins < price) {
                showMessage("¬°No tienes suficientes monedas para esta mejora!");
                return;
            }
            
            // Comprar la mejora
            gameState.coins -= price;
            gameState.upgrades[type] = currentLevel + 1;
            
            // Reiniciar usos de regadera al comprar mejora
            if (type === 'wateringCan') {
                gameState.wateringUses = 0;
            }
            
            // Iniciar gato jardinero si se compra
            if (type === 'cat' && gameState.upgrades.cat === 1) {
                startCatAssistant();
            }
            
            showMessage(`¬°Has mejorado ${type === 'wateringCan' ? 'Regadera' : type === 'fertilizer' ? 'Fertilizante' : 'Gato jardinero'} a nivel ${currentLevel + 1}!`);
            
            // Actualizar UI
            updateUI();
        }
        
        // Iniciar el gato jardinero
        function startCatAssistant() {
            if (gameState.catInterval) {
                clearInterval(gameState.catInterval);
            }
            
            if (gameState.upgrades.cat > 0) {
                const intervals = [30000, 20000, 8000]; // 30s, 20s, 8s
                const intervalTime = intervals[gameState.upgrades.cat - 1];
                
                gameState.catInterval = setInterval(() => {
                    catAction();
                }, intervalTime);
            }
        }
        
        // Acci√≥n del gato jardinero
        function catAction() {
            const emptyPots = Object.keys(gameState.garden).filter(potId => !gameState.garden[potId]);
            const readyPots = Object.keys(gameState.garden).filter(potId => {
                const mushroom = gameState.garden[potId];
                return mushroom && (mushroom.phase === 5 || mushroom.phase === 6);
            });
            
            // Si hay setas listas para cosechar, cosechar una
            if (readyPots.length > 0) {
                const randomPotId = readyPots[Math.floor(Math.random() * readyPots.length)];
                const mushroom = gameState.garden[randomPotId];
                
                if (mushroom.phase === 5) {
                    harvestMushroom(randomPotId, mushroom);
                } else {
                    harvestSpecialMushroom(randomPotId, mushroom);
                }
                
                showMessage("üê± ¬°El gato jardinero ha cosechado una seta por ti!");
                
                // Efecto visual del gato
                const gardenSection = document.querySelector('.garden-section');
                const cat = document.createElement('div');
                cat.className = 'cat-garden';
                cat.textContent = 'üê±';
                cat.style.top = '20px';
                gardenSection.appendChild(cat);
                
                setTimeout(() => {
                    if (cat.parentNode) {
                        cat.parentNode.removeChild(cat);
                    }
                }, 10000);
            } 
            // Si hay macetas vac√≠as, plantar una seta aleatoria
            else if (emptyPots.length > 0) {
                const randomPotId = emptyPots[Math.floor(Math.random() * emptyPots.length)];
                const types = ['red', 'blue', 'purple'];
                const randomType = types[Math.floor(Math.random() * types.length)];
                
                // Crear seta
                const colors = {
                    red: { stem: "#f5c0c0", cap: "#ff6b6b" },
                    blue: { stem: "#a0d2f5", cap: "#4d96ff" },
                    purple: { stem: "#d9b8ff", cap: "#9c51ff" }
                };
                
                const mushroom = {
                    type: randomType,
                    phase: 1,
                    height: 20,
                    capSize: 20,
                    stemColor: colors[randomType].stem,
                    capColor: colors[randomType].cap,
                    growthProgress: 0
                };
                
                // Plantar en la maceta
                gameState.garden[randomPotId] = mushroom;
                
                // Iniciar crecimiento
                startGrowth(randomPotId);
                
                showMessage(`üê± ¬°El gato jardinero ha plantado una seta ${randomType === 'red' ? 'roja' : randomType === 'blue' ? 'azul' : 'p√∫rpura'} por ti!`);
                
                // Efecto visual del gato
                const gardenSection = document.querySelector('.garden-section');
                const cat = document.createElement('div');
                cat.className = 'cat-garden';
                cat.textContent = 'üê±';
                cat.style.top = '20px';
                gardenSection.appendChild(cat);
                
                setTimeout(() => {
                    if (cat.parentNode) {
                        cat.parentNode.removeChild(cat);
                    }
                }, 10000);
            }
            
            updateUI();
        }
        
        // Manejar selecci√≥n de semilla
        function handleSeedSelect(type) {
            if (gameState.coins < mushroomPrices[type]) {
                showMessage("¬°No tienes suficientes monedas!");
                return;
            }
            
            // Crear seta
            const colors = {
                red: { stem: "#f5c0c0", cap: "#ff6b6b" },
                blue: { stem: "#a0d2f5", cap: "#4d96ff" },
                purple: { stem: "#d9b8ff", cap: "#9c51ff" }
            };
            
            const mushroom = {
                type: type,
                phase: 1,
                height: 20,
                capSize: 20,
                stemColor: colors[type].stem,
                capColor: colors[type].cap,
                growthProgress: 0
            };
            
            // Plantar en la maceta seleccionada
            gameState.garden[gameState.selectedPot] = mushroom;
            gameState.coins -= mushroomPrices[type];
            
            // Ocultar selector
            seedSelector.style.display = 'none';
            
            // Iniciar crecimiento
            startGrowth(gameState.selectedPot);
            
            // Actualizar UI
            updateUI();
            showMessage(`¬°Has plantado una seta ${type === 'red' ? 'roja' : type === 'blue' ? 'azul' : 'p√∫rpura'}!`);
        }
        
        // Iniciar crecimiento de la seta con fertilizante
        function startGrowth(potId) {
            // Detener cualquier intervalo existente para esta maceta
            if (gameState.growthIntervals[potId]) {
                clearInterval(gameState.growthIntervals[potId]);
            }
            
            const mushroom = gameState.garden[potId];
            
            // Obtener velocidad de crecimiento seg√∫n el tipo y fertilizante
            let baseInterval = growthSpeeds[mushroom.type];
            
            // Aplicar efecto de fertilizante
            const fertilizerBonus = [0, 0.1, 0.15, 0.2][gameState.upgrades.fertilizer];
            const intervalTime = baseInterval * (1 - fertilizerBonus);
            
            // Crear intervalo de crecimiento
            gameState.growthIntervals[potId] = setInterval(() => {
                if (!mushroom) return;
                
                // Incrementar progreso de crecimiento
                mushroom.growthProgress += 5;
                
                // Avanzar a la siguiente fase si es necesario
                if (mushroom.growthProgress >= 100) {
                    mushroom.phase++;
                    mushroom.growthProgress = 0;
                    
                    // Aumentar tama√±o hasta la fase 5
                    if (mushroom.phase <= 5) {
                        mushroom.height += 15;
                        mushroom.capSize += 5;
                    }
                    
                    // Mostrar mensaje al alcanzar fase 6
                    if (mushroom.phase === 6) {
                        showMessage(`¬°Una seta ha alcanzado la fase 6 y producir√° esporas especiales!`);
                        
                        // Crear efecto de esporas al alcanzar fase 6
                        createSporeEffect(potId);
                        
                        // Detener crecimiento despu√©s de la fase 6
                        clearInterval(gameState.growthIntervals[potId]);
                        return;
                    }
                }
                
                // Actualizar UI
                updateUI();
            }, intervalTime);
        }
        
        // Crear efecto de esporas al alcanzar fase 6
        function createSporeEffect(potId) {
            const pot = document.getElementById(potId);
            const sporesCount = 10;
            
            for (let i = 0; i < sporesCount; i++) {
                const spore = document.createElement('div');
                spore.className = 'spores';
                spore.textContent = '‚ú®';
                spore.style.left = `${Math.random() * 80 + 10}%`;
                spore.style.bottom = `${Math.random() * 30 + 30}%`;
                pot.appendChild(spore);
                
                // Eliminar despu√©s de la animaci√≥n
                setTimeout(() => {
                    if (spore.parentNode) {
                        spore.parentNode.removeChild(spore);
                    }
                }, 3000);
            }
        }
        
        // Cosechar seta normal
        function harvestMushroom(potId, mushroom) {
            // A√±adir al inventario
            gameState.inventory[mushroom.type]++;
            
            // Limpiar maceta
            gameState.garden[potId] = null;
            clearInterval(gameState.growthIntervals[potId]);
            
            // Actualizar UI
            updateUI();
            showMessage(`¬°Has cosechado una seta ${mushroom.type === 'red' ? 'roja' : mushroom.type === 'blue' ? 'azul' : 'p√∫rpura'}!`);
        }
        
        // Cosechar seta especial (fase 6)
        function harvestSpecialMushroom(potId, mushroom) {
            // A√±adir seta al inventario
            gameState.inventory[mushroom.type]++;
            
            // Generar esporas
            const sporesCount = 3 + Math.floor(Math.random() * 3);
            gameState.spores += sporesCount;
            
            // Limpiar maceta
            gameState.garden[potId] = null;
            clearInterval(gameState.growthIntervals[potId]);
            
            // Efecto visual de esporas
            createSporeEffect(potId);
            
            // Actualizar UI
            updateUI();
            showMessage(`¬°Has cosechado una seta especial y obtenido ${sporesCount} esporas!`);
        }
        
        // Abrir selector de inventario para el caldero
        function openInventorySelector(slot) {
            // Si tienes la rana alquimista, permite a√±adir a la cola aunque est√© ocupado
            if (gameState.isPreparing && !gameState.alchemistFrog) {
                showMessage("¬°El caldero est√° ocupado preparando una poci√≥n!");
                return;
            }
            
            gameState.currentSlot = slot;
            
            // Verificar si tiene setas en el inventario
            if (gameState.inventory.red === 0 && gameState.inventory.blue === 0 && gameState.inventory.purple === 0) {
                showMessage("¬°No tienes setas en tu inventario!");
                return;
            }
            
            inventorySelector.style.display = 'block';
        }
        
        // Seleccionar ingrediente para el caldero
        function selectIngredient(type) {
            if (gameState.inventory[type] > 0) {
                // Asignar al slot actual
                if (gameState.currentSlot === 1) {
                    gameState.ingredients.slot1 = type;
                } else {
                    gameState.ingredients.slot2 = type;
                }
                
                // Reducir inventario
                gameState.inventory[type]--;
                
                // Actualizar UI
                updateUI();
                
                // Cerrar selector
                inventorySelector.style.display = 'none';
                
                showMessage(`Has seleccionado una seta ${type === 'red' ? 'roja' : type === 'blue' ? 'azul' : 'p√∫rpura'} para el caldero`);
            } else {
                showMessage(`¬°No tienes setas ${type === 'red' ? 'rojas' : type === 'blue' ? 'azules' : 'p√∫rpuras'}!`);
            }
        }
        
        // Mezclar ingredientes en el caldero
        function mixIngredients() {
            // Si la rana alquimista est√° activa, soporta cola de recetas
            if (gameState.alchemistFrog && gameState.isPreparing) {
                if (gameState.cauldronQueue.length < 5 && gameState.ingredients.slot1 && gameState.ingredients.slot2) {
                    gameState.cauldronQueue.push({
                        slot1: gameState.ingredients.slot1,
                        slot2: gameState.ingredients.slot2
                    });
                    showMessage('Receta a√±adida a la cola del caldero.');
                    gameState.ingredients.slot1 = null;
                    gameState.ingredients.slot2 = null;
                    updateCauldronSlots();
                    // Mostrar la cola visual siempre que haya al menos una receta en cola
                    const queueList = document.getElementById('cauldronQueueList');
                    if (gameState.cauldronQueue.length > 0) {
                        let html = '<div style="background:rgba(0,0,0,0.3);border-radius:10px;padding:8px 12px;"><b>Cola de recetas:</b><ul style="margin:8px 0 0 0;padding:0;list-style:none;">';
                        gameState.cauldronQueue.forEach((receta, idx) => {
                            const combo = combinations[receta.slot1 + '-' + receta.slot2];
                            html += `<li style='margin-bottom:4px;'>${combo ? combo.emoji : 'üçÑ'} <span>${combo ? combo.name : receta.slot1 + ' + ' + receta.slot2}</span></li>`;
                        });
                        html += '</ul></div>';
                        queueList.innerHTML = html;
                    } else {
                        queueList.innerHTML = '';
                    }
                } else if (gameState.cauldronQueue.length >= 5) {
                    showMessage('La cola del caldero est√° llena (m√°x 5 recetas).');
                }
                return;
            }
            if (gameState.isPreparing) return;
            // Ordenar ingredientes para que el orden no afecte la combinaci√≥n
            const slots = [gameState.ingredients.slot1, gameState.ingredients.slot2].sort();
            const key = `${slots[0]}-${slots[1]}`;
            const combination = combinations[key];
            if (combination) {
                showMessage("¬°Receta aceptada! Preparando poci√≥n...");
                // Deshabilitar el caldero durante la preparaci√≥n
                gameState.isPreparing = true;
                mixButton.disabled = true;
                // Siempre desbloquear los slots despu√©s de colocar ingredientes
                slot1.style.pointerEvents = 'auto';
                slot2.style.pointerEvents = 'auto';
                // Mostrar temporizador
                preparationTimer.style.display = 'block';
                const prepTime = preparationTimes[combination.item];
                let currentTime = prepTime;
                timerValue.textContent = `${currentTime}s`;
                // Actualizar barra de progreso
                const timerInterval = setInterval(() => {
                    currentTime--;
                    timerValue.textContent = `${currentTime}s`;
                    preparationProgress.style.width = `${100 - (currentTime / prepTime * 100)}%`;
                    if (currentTime <= 0) {
                        clearInterval(timerInterval);
                        preparationTimer.style.display = 'none';
                        // A√±adir objeto creado
                        gameState.craftedItems[combination.item]++;
                        gameState.inventory.potion++;
                        // Actualizar UI
                        updateUI();
                        // Mostrar resultado
                        resultItem.textContent = combination.emoji;
                        resultName.textContent = combination.name;
                        craftingResult.style.display = 'block';
                        // Efecto visual del caldero
                        animateCauldron(combination.item);
                        // Limpiar slots
                        gameState.ingredients.slot1 = null;
                        gameState.ingredients.slot2 = null;
                        updateCauldronSlots();
                        // Reactivar caldero
                        gameState.isPreparing = false;
                        slot1.style.pointerEvents = 'auto';
                        slot2.style.pointerEvents = 'auto';
                        showMessage(`¬°Has creado un ${combination.name}!`);
                        // Si la rana est√° activa y hay recetas en cola, inicia la siguiente autom√°ticamente
                        if (gameState.alchemistFrog && gameState.cauldronQueue.length > 0) {
                            const next = gameState.cauldronQueue.shift();
                            gameState.ingredients.slot1 = next.slot1;
                            gameState.ingredients.slot2 = next.slot2;
                            updateCauldronSlots();
                            // Mostrar la cola visual actualizada despu√©s de procesar una receta
                            const queueList = document.getElementById('cauldronQueueList');
                            if (gameState.cauldronQueue.length > 0) {
                                let html = '<div style="background:rgba(0,0,0,0.3);border-radius:10px;padding:8px 12px;"><b>Cola de recetas:</b><ul style="margin:8px 0 0 0;padding:0;list-style:none;">';
                                gameState.cauldronQueue.forEach((receta, idx) => {
                                    const combo = combinations[receta.slot1 + '-' + receta.slot2];
                                    html += `<li style='margin-bottom:4px;'>${combo ? combo.emoji : 'üçÑ'} <span>${combo ? combo.name : receta.slot1 + ' + ' + receta.slot2}</span></li>`;
                                });
                                html += '</ul></div>';
                                queueList.innerHTML = html;
                            } else {
                                queueList.innerHTML = '';
                            }
                            setTimeout(() => {
                                mixIngredients();
                            }, 1200);
                        }
                        // Ocultar resultado despu√©s de un tiempo
                        setTimeout(() => {
                            craftingResult.style.display = 'none';
                        }, 3000);
                    }
                }, 1000);
            } else {
                showMessage("¬°Esos ingredientes no se pueden combinar!");
            }
        }
        
        // Vender al cliente del d√≠a
        function sellToCustomer() {
            if (!gameState.dailyCustomer) return;
            
            let totalEarnings = 0;
            const customerType = gameState.dailyCustomer.type;
            const wishlist = gameState.dailyWishlist;
            const prices = sellPrices[customerType];
            
            // Verificar si tenemos suficiente para vender
            let canSell = true;
            for (const item in wishlist) {
                let available = 0;
                
                if (item === 'red' || item === 'blue' || item === 'purple') {
                    available = gameState.inventory[item];
                } else if (item === 'potion_red') {
                    available = gameState.craftedItems.red;
                } else if (item === 'potion_blue') {
                    available = gameState.craftedItems.blue;
                } else if (item === 'potion_purple') {
                    available = gameState.craftedItems.purple;
                } else if (item === 'rainbow') {
                    available = gameState.craftedItems.rainbow;
                } else if (item === 'ether') {
                    available = gameState.craftedItems.ether;
                }
                
                if (available < wishlist[item]) {
                    canSell = false;
                    break;
                }
            }
            
            if (!canSell) {
                showMessage("¬°No tienes suficientes art√≠culos para completar el pedido!");
                return;
            }
            
            // Vender los art√≠culos
            for (const item in wishlist) {
                const quantity = wishlist[item];
                
                if (item === 'red' || item === 'blue' || item === 'purple') {
                    gameState.inventory[item] -= quantity;
                    totalEarnings += prices.mushroom * quantity;
                } else if (item === 'potion_red') {
                    gameState.craftedItems.red -= quantity;
                    totalEarnings += prices.potion_red * quantity;
                } else if (item === 'potion_blue') {
                    gameState.craftedItems.blue -= quantity;
                    totalEarnings += prices.potion_blue * quantity;
                } else if (item === 'potion_purple') {
                    gameState.craftedItems.purple -= quantity;
                    totalEarnings += prices.potion_purple * quantity;
                } else if (item === 'rainbow') {
                    gameState.craftedItems.rainbow -= quantity;
                    totalEarnings += prices.rainbow * quantity;
                } else if (item === 'ether') {
                    gameState.craftedItems.ether -= quantity;
                    totalEarnings += prices.ether * quantity;
                }
            }
            
            // A√±adir ganancias
            gameState.coins += totalEarnings;
            
            // Generar nuevo cliente para el siguiente d√≠a
            generateDailyCustomer();
            
            // Actualizar UI
            updateUI();
            showMessage(`¬°Has vendido al cliente por ${totalEarnings} monedas!`);
        }
        
        // Animar el caldero al crear una poci√≥n
        function animateCauldron(itemType) {
            const cauldronLiquid = document.getElementById('cauldronLiquid');
            let color1, color2;
            
            // Slot 1
            if (gameState.ingredients.slot1) {
                slot1.innerHTML = gameState.ingredients.slot1 === 'red' ? 'üçÑ' : 
                                 gameState.ingredients.slot1 === 'blue' ? 'üçÑ' : 'üçÑ';
                slot1.style.fontSize = '2.2rem';
                slot1.style.backgroundColor = gameState.ingredients.slot1 === 'red' ? 'rgba(255, 100, 100, 0.7)' :
                                             gameState.ingredients.slot1 === 'blue' ? 'rgba(100, 100, 255, 0.7)' : 
                                             'rgba(180, 100, 255, 0.7)';
            } else {
                slot1.innerHTML = '+';
                slot1.style.fontSize = '1.8rem';
                slot1.style.backgroundColor = 'rgba(139, 69, 19, 0.6)';
            }
            // Slot 2
            if (gameState.ingredients.slot2) {
                slot2.innerHTML = gameState.ingredients.slot2 === 'red' ? 'üçÑ' : 
                                 gameState.ingredients.slot2 === 'blue' ? 'üçÑ' : 'üçÑ';
                slot2.style.fontSize = '2.2rem';
                slot2.style.backgroundColor = gameState.ingredients.slot2 === 'red' ? 'rgba(255, 100, 100, 0.7)' :
                                             gameState.ingredients.slot2 === 'blue' ? 'rgba(100, 100, 255, 0.7)' : 
                                             'rgba(180, 100, 255, 0.7)';
            } else {
                slot2.innerHTML = '+';
                slot2.style.fontSize = '1.8rem';
                slot2.style.backgroundColor = 'rgba(139, 69, 19, 0.6)';
            }
            // Activar o desactivar bot√≥n de mezcla
            mixButton.disabled = !(gameState.ingredients.slot1 && gameState.ingredients.slot2) || gameState.isPreparing;
            // Mostrar cola visual si la rana est√° activa
            const queueList = document.getElementById('cauldronQueueList');
            if (gameState.alchemistFrog && gameState.cauldronQueue.length > 0) {
                let html = '<div style="background:rgba(0,0,0,0.3);border-radius:10px;padding:8px 12px;"><b>Cola de recetas:</b><ul style="margin:8px 0 0 0;padding:0;list-style:none;">';
                gameState.cauldronQueue.forEach((receta, idx) => {
                    const comboKey = `${receta.slot1}-${receta.slot2}`;
                    const combo = combinations[comboKey];
                    html += `<li style='margin-bottom:4px;'>${combo ? combo.emoji : 'üçÑ'} <span>${combo ? combo.name : receta.slot1 + ' + ' + receta.slot2}</span></li>`;
                });
                html += '</ul></div>';
                queueList.innerHTML = html;
            } else {
                queueList.innerHTML = '';
            }
            setTimeout(() => {
                cauldronLiquid.style.background = 'linear-gradient(to top, #4b0082, #8a2be2)';
                cauldronLiquid.style.boxShadow = '0 0 15px rgba(138, 43, 226, 0.5)';
            }, 3000);
        }
        
        // Crear burbujas para el caldero
        function createBubbles() {
            const cauldronBubbles = document.getElementById('cauldronBubbles');
            
            // Crear burbujas iniciales
            createExtraBubbles(8);
            
            // Crear nuevas burbujas peri√≥dicamente
            setInterval(() => {
                createExtraBubbles(3);
            }, 2000);
        }
        
        // Crear burbujas adicionales
        function createExtraBubbles(count) {
            const cauldronBubbles = document.getElementById('cauldronBubbles');
            
            for (let i = 0; i < count; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                
                // Tama√±o aleatorio
                const size = Math.random() * 12 + 4;
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                // Posici√≥n aleatoria
                bubble.style.left = `${Math.random() * 100}%`;
                bubble.style.bottom = `${Math.random() * 20}%`;
                
                // Tiempo de animaci√≥n aleatorio
                bubble.style.animationDuration = `${Math.random() * 2 + 2}s`;
                
                cauldronBubbles.appendChild(bubble);
                
                // Eliminar burbuja despu√©s de la animaci√≥n
                setTimeout(() => {
                    if (bubble.parentNode) {
                        bubble.parentNode.removeChild(bubble);
                    }
                }, 5000);
            }
        }
        
        // Mostrar mensaje en la interfaz
        function showMessage(message) {
            messageBox.textContent = message;
            messageBox.style.display = 'block';
            
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 3000);
        }
        
        // Ciclo de d√≠a/noche
        function startDayCycle() {
            setInterval(() => {
                gameState.day++;
                gameState.wateringUses = 0; // Resetear usos de regadera
                
                // Generar nuevo cliente cada d√≠a
                generateDailyCustomer();
                
                // Ejecutar regadera nivel 3 autom√°ticamente
                if (gameState.upgrades.wateringCan >= 3) {
                    autoWaterPlants();
                }
                
                // Actualizar UI
                updateUI();
                showMessage(`¬°Ha comenzado un nuevo d√≠a!`);
                
                // Animaci√≥n de deslizamiento para el cliente
                const customerContainer = document.querySelector('.daily-customer-container');
                customerContainer.style.overflow = 'hidden';
                const customer = document.getElementById('dailyCustomer');
                customer.style.transform = 'translateY(-200px)';
                
                setTimeout(() => {
                    customer.style.transition = 'transform 0.5s ease';
                    customer.style.transform = 'translateY(0)';
                }, 100);
                
                // Peque√±a posibilidad de obtener esporas gratis
                if (Math.random() > 0.7) {
                    const freeSpores = 1 + Math.floor(Math.random() * 3);
                    gameState.spores += freeSpores;
                    showMessage(`¬°Has encontrado ${freeSpores} esporas durante la noche!`);
                    updateUI();
                }
            }, 60000); // 1 minuto = 1 d√≠a
        }
        
        // Regar plantas autom√°ticamente (nivel 3 de regadera)
        function autoWaterPlants() {
            const pots = Object.keys(gameState.garden);
            let watered = 0;
            
            for (const potId of pots) {
                if (watered >= 2) break; // Solo 2 plantas por d√≠a
                
                const mushroom = gameState.garden[potId];
                if (mushroom && mushroom.phase < 6) {
                    mushroom.phase++;
                    
                    // Aumentar tama√±o
                    if (mushroom.phase <= 5) {
                        mushroom.height += 15;
                        mushroom.capSize += 5;
                    }
                    
                    watered++;
                    
                    // Efecto visual
                    const pot = document.getElementById(potId);
                    const wateringEffect = document.createElement('div');
                    wateringEffect.className = 'watering-can';
                    wateringEffect.textContent = 'üöø';
                    wateringEffect.style.left = `${Math.random() * 70 + 15}%`;
                    pot.appendChild(wateringEffect);
                    
                    setTimeout(() => {
                        if (wateringEffect.parentNode) {
                            wateringEffect.parentNode.removeChild(wateringEffect);
                        }
                    }, 1000);
                    
                    // Mostrar mensaje si alcanza fase 6
                    if (mushroom.phase === 6) {
                        showMessage(`¬°La seta en ${potId} ha alcanzado la fase 6!`);
                        createSporeEffect(potId);
                    }
                }
            }
            
            if (watered > 0) {
                showMessage(`¬°La regadera autom√°tica ha acelerado ${watered} setas!`);
                updateUI();
            }
        }
        
        // --- Men√∫ debug discreto ---
        let debugUnlocked = false;
        const debugMenu = document.getElementById('debugMenu');
        if (debugMenu) {
            debugMenu.innerHTML = `<span style='opacity:0.7;'>Debug</span>`;
            debugMenu.addEventListener('click', () => {
                if (!debugUnlocked) {
                    const pwd = prompt('Introduce la contrase√±a de debug:');
                    if (pwd === 'irelia') {
                        debugUnlocked = true;
                        showDebugMenu();
                    }
                }
            });
        }
        function showDebugMenu() {
            debugMenu.style.opacity = '1';
            debugMenu.innerHTML = `
                <b>Debug</b><br>
                <button onclick='window.stopDayCycle()'>Detener D√≠a</button>
                <button onclick='window.instantBrewing()'>Instant Brewing</button><br>
                <button onclick='window.upgradeWatering()'>Regadera +</button>
                <button onclick='window.upgradeFertilizer()'>Fertilizante +</button>
                <button onclick='window.upgradeCat()'>Gato +</button><br>
                <button onclick='window.addCoins()'>+100 Monedas</button>
                <button onclick='window.addSpores()'>+10 Esporas</button>
            `;
        }
        window.stopDayCycle = function() {
            if (window.dayCycleInterval) clearInterval(window.dayCycleInterval);
            showMessage('Ciclo de d√≠a detenido');
        };
        window.instantBrewing = function() {
            preparationTimes.red = 1;
            preparationTimes.blue = 1;
            preparationTimes.purple = 1;
            preparationTimes.rainbow = 1;
            preparationTimes.ether = 1;
            showMessage('Instant brewing activado');
        };
        window.upgradeWatering = function() {
            gameState.upgrades.wateringCan = Math.min(gameState.upgrades.wateringCan + 1, 3);
            updateUI();
            showMessage('Regadera mejorada');
        };
        window.upgradeFertilizer = function() {
            gameState.upgrades.fertilizer = Math.min(gameState.upgrades.fertilizer + 1, 3);
            updateUI();
            showMessage('Fertilizante mejorado');
        };
        window.upgradeCat = function() {
            gameState.upgrades.cat = Math.min(gameState.upgrades.cat + 1, 3);
            startCatAssistant();
            updateUI();
            showMessage('Gato mejorado');
        };
        window.addCoins = function() {
            gameState.coins += 100;
            updateUI();
            showMessage('Monedas a√±adidas');
        };
        window.addSpores = function() {
            gameState.spores += 10;
            updateUI();
            showMessage('Esporas a√±adidas');
        };
        // Iniciar el juego cuando se carga la p√°gina
        window.onload = initGame;
    </script>
</body>
</html>